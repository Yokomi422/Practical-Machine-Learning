import LinearRegression from '../../../src/components/Graphs/scatter';
import Answer from "../../../src/components/Answer/Answer"


# 線形回帰(Liner Regression)

それでは早速、もっともシンプルな線形回帰を実装してみましょう。
## 線形回帰とは

線形回帰とは、データの傾向を直線(三次元では平面、それの次元では超平面)で表現する手法です。
例えば、身長と体重を測定したデータがあったとします。
このデータを直線で表現すると、以下のようになります。

<LinearRegression/>

### 練習問題
上では、身長と体重のデータを直線で表現しました。
実は、直線の傾きと切片は以下の式(正規方程式)を解くことで求めることができます。
正規方程式をPythonで実装してみましょう。

データは以下のように与えられています。

``` python
X = np.array([171, 180, 175, 171, 163, 168, 176, 173, 174, 164, 171, 172, 172, 175, 163, 163, 162, 167, 170, 173, 170, 170, 175, 170])
y = np.array([62, 71, 53, 78, 54, 62, 60, 62, 60, 50, 66, 69, 63, 62, 65, 53, 52, 60, 67, 70, 67, 56, 68, 56])
```

<Answer>
</Answer>

## 線形回帰の実装

上ではスクラッチで線形回帰を実装しましたが、scikit-learnというライブラリを使うことで簡単に実装することができます。


:::tip tips
scikit-learnは機械学習のライブラリです。機械学習アルゴリズムが実装されているので、わざわざ自分で実装する必要がなく、簡単に機械学習を
実装することができます。  
そのように聞くと、アルゴリズムなんて理解しなくても、scikit-learnを使えばいいのでは？と思うかもしれませんが、
ハイパーパラメータの調整などは自分で行う必要があり、これにはアルゴリズムの理解が不可欠です。
:::

### モジュールのインポート

``` python
from sklearn.linear_model import LinearRegression
```

### モデルの構築

``` python
lin_reg = LinearRegression()
lin_reg.fit(X, y)
```
- lin_reg = LinearRegression()はインスタンスを生成しています。
- lin_reg.fit(X, y)はモデルを学習させています。

### モデルの中身を見てみる
    
``` python
print(lin_reg.coef_)
print(lin_reg.intercept_)
```
- lin_reg.coef_は傾きを表しています。
- lin_reg.intercept_は切片を表しています。
